<?xml version="1.0"?>

<!-- Piper PA28 Cockpit -->
<!-- Copyright (c) 2019 Joshua Davidson (Octal450) -->

<system name="PA28: Cockpit"> <!-- Everything here is after all systems -->
	
	<channel name="Animations">
		
		<lag_filter name="/controls/switches/nav-lights-knob">
			<input>/controls/switches/nav-lights-factor</input>
			<c1>20</c1>
		</lag_filter>
		
		<lag_filter name="/controls/switches/panel-lights-knob">
			<input>/controls/switches/panel-lights-factor</input>
			<c1>20</c1>
		</lag_filter>
	
	</channel>
	
	<channel name="Avionics Fan">
		
		<fcs_function name="libraries/av-fan-rpm-inc">
			<function>
				<sum>
					<property>libraries/av-fan-rpm-feedback</property>
					<value>10.0</value>
				</sum>
			</function>
		</fcs_function>
		
		<fcs_function name="libraries/av-fan-rpm-dec">
			<function>
				<difference>
					<property>libraries/av-fan-rpm-feedback</property>
					<value>2.0</value>
				</difference>
			</function>
		</fcs_function>
		
		<switch name="libraries/av-fan-rpm-switch">
			<default value="libraries/av-fan-rpm-switch"/>
			<test logic="AND" value="libraries/av-fan-rpm-inc">
				/systems/electrical/bus/elec1 ge 8
				libraries/av-fan-rpm-feedback lt 6450
			</test>
			<test logic="AND" value="libraries/av-fan-rpm-inc">
				/systems/electrical/bus/elec2 ge 8
				libraries/av-fan-rpm-feedback lt 6450
			</test>
			<test logic="AND" value="libraries/av-fan-rpm-dec">
				/systems/electrical/bus/elec1 lt 8
				/systems/electrical/bus/elec2 lt 8
				libraries/av-fan-rpm-feedback gt 0
			</test>
			<output>libraries/av-fan-rpm-feedback</output>
		</switch>
	
	</channel>

</system>
